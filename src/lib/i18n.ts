import { writable, derived } from "svelte/store";

type Lang = "de" | "en" | "fr" | "it";

const defaultLang: Lang = "de";

const dictionaries: Record<Lang, Record<string, string>> = {
  de: {
    "nav.reisen": "Reisen",
    "nav.bucketlist": "Bucketlist",
    "nav.karte": "Karte",
    "nav.profil": "Profil",
    "nav.logout": "Logout",
    "nav.language": "Sprache",

    "auth.loginTitle": "Einloggen",
    "auth.loginSubtitle": "Mit E-Mail oder Google anmelden.",
    "auth.email": "E-Mail",
    "auth.password": "Passwort",
    "auth.loginButton": "Login",
    "auth.or": "ODER",
    "auth.google": "Mit Google anmelden",
    "auth.noAccount": "Noch kein Konto?",
    "auth.registerNow": "Jetzt registrieren",
    "auth.verifyHint": "Bitte bestätige deine E-Mail-Adresse. Schaue auch im Spam-Ordner.",

    "register.title": "Registrieren",
    "register.subtitle": "Erstelle dein Reisetagebuch-Konto und halte deine schönsten Erinnerungen fest.",
    "register.firstname": "Vorname",
    "register.lastname": "Nachname",
    "register.birthday": "Geburtsdatum",
    "register.email": "E-Mail",
    "register.password": "Passwort",
    "register.submit": "Registrieren",
    "register.loading": "Registriere...",
    "register.success": "Registrierung erfolgreich! Bitte bestätige deine E-Mail-Adresse. Überprüfe dein Postfach (und Spam-Ordner).",
    "register.duplicate": "Diese E-Mail ist bereits registriert. Bitte logge dich ein.",
    "register.noAccount": "Schon ein Konto?",
    "register.loginNow": "Jetzt einloggen"

    ,
    "home.title": "Hallo {name}",
    "home.subtitle": "Deine Reisen, Bucketlist und Globe in einer Ansicht.",
    "home.trips": "Reisen",
    "home.tripsHint": "Deine Trips im Überblick",
    "home.tripsEmpty": "Du hast noch keine Reisen erfasst.",
    "home.bucket": "Bucket List",
    "home.bucketHint": "Deine nächsten Ziele",
    "home.bucketEmpty": "Noch keine Ziele erfasst.",
    "home.bucketError": "Bucketlist konnte nicht geladen werden.",
    "home.map": "Weltkarte"
    ,
    "trips.title": "Meine Reisen",
    "trips.cta": "Neue Reise hinzufügen",
    "trips.empty": "Du hast noch keine Reisen angelegt. Klicke oben auf \"Neue Reise hinzufügen\".",
    "trips.loading": "Reisen werden geladen..."
    ,
    "bucket.title": "Bucketlist",
    "bucket.cta": "Traumdestination hinzufügen",
    "bucket.loading": "Bucketlist wird geladen...",
    "bucket.empty": "Keine Bucketlist vorhanden. Lege oben eine Traumdestination an.",
    "bucket.error": "Bucketlist konnte nicht geladen werden.",
    "bucket.itemYear": "Voraussichtlich: {year}"
    ,
    "tripForm.title": "Neue Reise hinzufügen",
    "tripForm.location": "Ort",
    "tripForm.withWhom": "Mit wem",
    "tripForm.cost": "Kosten (CHF)",
    "tripForm.rating": "Rating (1-10)",
    "tripForm.description": "Beschreibung",
    "tripForm.images": "Bilder hochladen",
    "tripForm.start": "Startdatum",
    "tripForm.end": "Enddatum",
    "tripForm.save": "Speichern",
    "tripForm.cancel": "Abbrechen",
    "tripForm.error": "Bitte alle Pflichtfelder ausfüllen.",
    "tripForm.errorAuth": "Bitte melde dich erneut an.",
    "tripForm.errorLocation": "Bitte setze einen Standort auf der Karte.",
    "tripForm.errorSave": "Reise konnte nicht gespeichert werden.",
    "tripForm.errorUpload": "Bild-Upload ist fehlgeschlagen.",
    "tripForm.errorMongo": "Reise konnte nicht in MongoDB gespeichert werden.",
    "tripForm.placeholder.location": "z.B. Paris",
    "tripForm.placeholder.withWhom": "z.B. Luis",
    "tripForm.placeholder.cost": "z.B. 1200",
    "tripForm.placeholder.rating": "z.B. 8",
    "tripForm.placeholder.description": "Besondere Momente, Highlights, Erinnerungen...",
    "tripForm.locationPicker": "Standort setzen (Reise)",
    "bucketForm.title": "Traumdestination hinzufügen",
    "bucketForm.name": "Ort",
    "bucketForm.images": "Bilder hochladen",
    "bucketForm.locationPicker": "Standort setzen (Bucketlist)",
    "bucketForm.ideas": "Stichpunkte / Ideen",
    "bucketForm.placeholder.name": "z.B. Bora Bora",
    "bucketForm.placeholder.ideas": "• Must-See Spots\n• Restaurants ausprobieren\n• Aktivitäten am Wasser",
    "bucketForm.save": "Traumdestination speichern",
    "bucketForm.cancel": "Abbrechen",
    "bucketForm.errorAuth": "Bitte melde dich erneut an (kein Benutzer gefunden).",
    "bucketForm.errorUpload": "Bild-Upload fehlgeschlagen:",
    "bucketForm.errorLocation": "Bitte setze einen Standort auf der Karte.",
    "bucketForm.errorSave": "Traumdestination konnte nicht gespeichert werden."
    ,
    "profile.title": "Profil",
    "profile.cards.reisen": "Reisen",
    "profile.cards.bucket": "Bucketlist",
    "profile.cards.costs": "Gesamtkosten Reisen",
    "profile.cards.tripsLabel": "bereits festgehaltene Trips",
    "profile.cards.bucketLabel": "Ziele, die noch warten",
    "profile.cards.costsLabel": "CHF (Summe aller Trips)",
    "profile.fields.firstname": "Vorname",
    "profile.fields.lastname": "Nachname",
    "profile.fields.email": "E-Mail",
    "profile.fields.userId": "User-ID",
    "profile.fields.birthday": "Geburtstag",
    "profile.fields.created": "Registriert am",
    "profile.delete.title": "Profil löschen",
    "profile.delete.body": "Entfernt deine Reisen und Bucketlist-Einträge und meldet dich ab.",
    "profile.delete.button": "Profil löschen",
    "profile.delete.confirm": "Wirklich löschen?",
    "profile.error.auth": "Bitte melde dich neu an.",
    "profile.error.delete": "Löschen fehlgeschlagen. Bitte versuche es später erneut.",
    "profile.delete.marked": "Dein Account wurde zur Löschung markiert. Du kannst ihn innerhalb von 30 Tagen reaktivieren.",
    "profile.hero.eyebrow": "Dein Profil",
    "profile.hero.since": "seit",
    "profile.warning.title": "Zur Löschung markiert",
    "profile.warning.body": "Dein Konto wird nach dem {date} endgültig entfernt.",
    "profile.warning.hint": "Melde dich einfach an oder klicke unten, um es sofort zu reaktivieren.",
    "profile.warning.reactivate": "Konto reaktivieren",
    "profile.delete.hint": "Dein Konto wird 30 Tage lang zur Wiederherstellung vorgemerkt. In dieser Zeit kannst du es reaktivieren, sonst wird es endgültig gelöscht.",
    "profile.delete.confirmTitle": "Bist du sicher?",
    "profile.delete.confirmHint": "Dieser Schritt markiert dein Konto zur Löschung.",
    "profile.delete.markAction": "Endgültig markieren",
    "profile.delete.loading": "Lösche..."
  },
  en: {
    "nav.reisen": "Trips",
    "nav.bucketlist": "Bucket List",
    "nav.karte": "Map",
    "nav.profil": "Profile",
    "nav.logout": "Logout",
    "nav.language": "Language",

    "auth.loginTitle": "Login",
    "auth.loginSubtitle": "Sign in with email or Google.",
    "auth.email": "Email",
    "auth.password": "Password",
    "auth.loginButton": "Login",
    "auth.or": "OR",
    "auth.google": "Sign in with Google",
    "auth.noAccount": "No account yet?",
    "auth.registerNow": "Register now",
    "auth.verifyHint": "Please verify your email address. Check your inbox and spam folder.",

    "register.title": "Register",
    "register.subtitle": "Create your travel diary account and capture your best memories.",
    "register.firstname": "First name",
    "register.lastname": "Last name",
    "register.birthday": "Date of birth",
    "register.email": "Email",
    "register.password": "Password",
    "register.submit": "Register",
    "register.loading": "Registering...",
    "register.success": "Registration successful! Please verify your email address. Check your inbox and spam folder.",
    "register.duplicate": "This email is already registered. Please log in.",
    "register.noAccount": "Already have an account?",
    "register.loginNow": "Log in now"

    ,
    "home.title": "Hello {name}",
    "home.subtitle": "Your trips, bucket list and globe in one view.",
    "home.trips": "Trips",
    "home.tripsHint": "Your trips at a glance",
    "home.tripsEmpty": "You have not added any trips yet.",
    "home.bucket": "Bucket List",
    "home.bucketHint": "Your next goals",
    "home.bucketEmpty": "No goals added yet.",
    "home.bucketError": "Bucket list could not be loaded.",
    "home.map": "World map"
    ,
    "trips.title": "My Trips",
    "trips.cta": "Add new trip",
    "trips.empty": "You have not added any trips yet. Click \"Add new trip\" above.",
    "trips.loading": "Loading trips..."
    ,
    "bucket.title": "Bucket List",
    "bucket.cta": "Add dream destination",
    "bucket.loading": "Loading bucket list...",
    "bucket.empty": "No bucket list yet. Add a dream destination above.",
    "bucket.error": "Bucket list could not be loaded.",
    "bucket.itemYear": "Expected: {year}"
    ,
    "tripForm.title": "Add new trip",
    "tripForm.location": "Location",
    "tripForm.withWhom": "With whom",
    "tripForm.cost": "Cost (CHF)",
    "tripForm.rating": "Rating (1-10)",
    "tripForm.description": "Description",
    "tripForm.images": "Upload images",
    "tripForm.start": "Start date",
    "tripForm.end": "End date",
    "tripForm.save": "Save",
    "tripForm.cancel": "Cancel",
    "tripForm.error": "Please fill all required fields.",
    "tripForm.errorAuth": "Please log in again.",
    "tripForm.errorLocation": "Please set a location on the map.",
    "tripForm.errorSave": "Trip could not be saved.",
    "tripForm.errorUpload": "Image upload failed.",
    "tripForm.errorMongo": "Trip could not be saved to MongoDB.",
    "tripForm.placeholder.location": "e.g. Paris",
    "tripForm.placeholder.withWhom": "e.g. Luis",
    "tripForm.placeholder.cost": "e.g. 1200",
    "tripForm.placeholder.rating": "e.g. 8",
    "tripForm.placeholder.description": "Special moments, highlights, memories...",
    "tripForm.locationPicker": "Set location (trip)",
    "bucketForm.title": "Add dream destination",
    "bucketForm.name": "Place",
    "bucketForm.images": "Upload images",
    "bucketForm.locationPicker": "Set location (bucket list)",
    "bucketForm.ideas": "Notes / Ideas",
    "bucketForm.placeholder.name": "e.g. Bora Bora",
    "bucketForm.placeholder.ideas": "• Must-see spots\n• Try restaurants\n• Activities on/near water",
    "bucketForm.save": "Save dream destination",
    "bucketForm.cancel": "Cancel",
    "bucketForm.errorAuth": "Please log in again (no user found).",
    "bucketForm.errorUpload": "Image upload failed:",
    "bucketForm.errorLocation": "Please set a location on the map.",
    "bucketForm.errorSave": "Dream destination could not be saved."
    ,
    "profile.title": "Profile",
    "profile.cards.reisen": "Trips",
    "profile.cards.bucket": "Bucket list",
    "profile.cards.costs": "Total trip costs",
    "profile.cards.tripsLabel": "Trips recorded",
    "profile.cards.bucketLabel": "Goals waiting",
    "profile.cards.costsLabel": "CHF (sum of all trips)",
    "profile.fields.firstname": "First name",
    "profile.fields.lastname": "Last name",
    "profile.fields.email": "E-mail",
    "profile.fields.userId": "User ID",
    "profile.fields.birthday": "Birthday",
    "profile.fields.created": "Registered on",
    "profile.delete.title": "Delete profile",
    "profile.delete.body": "Removes your trips and bucket list entries and logs you out.",
    "profile.delete.button": "Delete profile",
    "profile.delete.confirm": "Really delete?",
    "profile.error.auth": "Please log in again.",
    "profile.error.delete": "Deletion failed. Please try again later.",
    "profile.delete.marked": "Your account was marked for deletion. You can reactivate within 30 days.",
    "profile.hero.eyebrow": "Your profile",
    "profile.hero.since": "since",
    "profile.warning.title": "Marked for deletion",
    "profile.warning.body": "Your account will be permanently removed after {date}.",
    "profile.warning.hint": "Just log in or click below to reactivate immediately.",
    "profile.warning.reactivate": "Reactivate account",
    "profile.delete.hint": "Your account is kept for 30 days for recovery. Within this time you can reactivate; afterwards it is deleted permanently.",
    "profile.delete.confirmTitle": "Are you sure?",
    "profile.delete.confirmHint": "This step marks your account for deletion.",
    "profile.delete.markAction": "Mark permanently",
    "profile.delete.loading": "Deleting..."
  },
  fr: {
    "nav.reisen": "Voyages",
    "nav.bucketlist": "Bucket List",
    "nav.karte": "Carte",
    "nav.profil": "Profil",
    "nav.logout": "Déconnexion",
    "nav.language": "Langue",

    "auth.loginTitle": "Connexion",
    "auth.loginSubtitle": "Connexion par email ou Google.",
    "auth.email": "E-mail",
    "auth.password": "Mot de passe",
    "auth.loginButton": "Se connecter",
    "auth.or": "OU",
    "auth.google": "Se connecter avec Google",
    "auth.noAccount": "Pas de compte ?",
    "auth.registerNow": "S'inscrire maintenant",
    "auth.verifyHint": "Veuillez vérifier votre adresse e-mail. Consultez aussi vos spams.",

    "register.title": "Inscription",
    "register.subtitle": "Crée ton journal de voyage et garde tes meilleurs souvenirs.",
    "register.firstname": "Prénom",
    "register.lastname": "Nom",
    "register.birthday": "Date de naissance",
    "register.email": "E-mail",
    "register.password": "Mot de passe",
    "register.submit": "S'inscrire",
    "register.loading": "Inscription...",
    "register.success": "Inscription réussie ! Merci de vérifier ton e-mail (boîte de réception et spams).",
    "register.duplicate": "Cet e-mail est déjà enregistré. Merci de te connecter.",
    "register.noAccount": "Déjà un compte ?",
    "register.loginNow": "Se connecter"

    ,
    "home.title": "Bonjour {name}",
    "home.subtitle": "Tes voyages, ta bucket list et le globe en un coup d'œil.",
    "home.trips": "Voyages",
    "home.tripsHint": "Tes voyages en un coup d'œil",
    "home.tripsEmpty": "Tu n'as encore ajouté aucun voyage.",
    "home.bucket": "Bucket List",
    "home.bucketHint": "Tes prochaines destinations",
    "home.bucketEmpty": "Aucun objectif ajouté.",
    "home.bucketError": "La bucket list n'a pas pu être chargée.",
    "home.map": "Carte du monde"
    ,
    "trips.title": "Mes voyages",
    "trips.cta": "Ajouter un voyage",
    "trips.empty": "Tu n'as encore ajouté aucun voyage. Clique sur \"Ajouter un voyage\".",
    "trips.loading": "Chargement des voyages..."
    ,
    "bucket.title": "Bucket List",
    "bucket.cta": "Ajouter une destination rêvée",
    "bucket.loading": "Chargement de la bucket list...",
    "bucket.empty": "Aucune bucket list. Ajoute une destination rêvée.",
    "bucket.error": "La bucket list n'a pas pu être chargée.",
    "bucket.itemYear": "Prévu: {year}"
    ,
    "tripForm.title": "Ajouter un voyage",
    "tripForm.location": "Lieu",
    "tripForm.withWhom": "Avec qui",
    "tripForm.cost": "Coût (CHF)",
    "tripForm.rating": "Note (1-10)",
    "tripForm.description": "Description",
    "tripForm.images": "Téléverser des images",
    "tripForm.start": "Date de début",
    "tripForm.end": "Date de fin",
    "tripForm.save": "Enregistrer",
    "tripForm.cancel": "Annuler",
    "tripForm.error": "Veuillez remplir tous les champs obligatoires.",
    "tripForm.errorAuth": "Merci de te reconnecter.",
    "tripForm.errorLocation": "Merci de définir un lieu sur la carte.",
    "tripForm.errorSave": "Le voyage n'a pas pu être enregistré.",
    "tripForm.errorUpload": "Échec du téléversement d'image.",
    "tripForm.errorMongo": "Le voyage n'a pas pu être enregistré dans MongoDB.",
    "tripForm.placeholder.location": "p.ex. Paris",
    "tripForm.placeholder.withWhom": "p.ex. Luis",
    "tripForm.placeholder.cost": "p.ex. 1200",
    "tripForm.placeholder.rating": "p.ex. 8",
    "tripForm.placeholder.description": "Moments spéciaux, points forts, souvenirs...",
    "tripForm.locationPicker": "Définir le lieu (voyage)",
    "bucketForm.title": "Ajouter une destination rêvée",
    "bucketForm.name": "Lieu",
    "bucketForm.images": "Téléverser des images",
    "bucketForm.locationPicker": "Définir le lieu (bucket list)",
    "bucketForm.ideas": "Notes / Idées",
    "bucketForm.placeholder.name": "p.ex. Bora Bora",
    "bucketForm.placeholder.ideas": "• Lieux à voir\n• Restaurants à essayer\n• Activités sur/près de l'eau",
    "bucketForm.save": "Enregistrer la destination rêvée",
    "bucketForm.cancel": "Annuler",
    "bucketForm.errorAuth": "Merci de te reconnecter (utilisateur introuvable).",
    "bucketForm.errorUpload": "Échec du téléversement d'image :",
    "bucketForm.errorLocation": "Merci de définir un lieu sur la carte.",
    "bucketForm.errorSave": "La destination rêvée n'a pas pu être enregistrée."
    ,
    "profile.title": "Profil",
    "profile.cards.reisen": "Voyages",
    "profile.cards.bucket": "Bucket list",
    "profile.cards.costs": "Coûts totaux des voyages",
    "profile.cards.tripsLabel": "Voyages enregistrés",
    "profile.cards.bucketLabel": "Objectifs en attente",
    "profile.cards.costsLabel": "CHF (somme de tous les voyages)",
    "profile.fields.firstname": "Prénom",
    "profile.fields.lastname": "Nom",
    "profile.fields.email": "E-mail",
    "profile.fields.userId": "ID utilisateur",
    "profile.fields.birthday": "Anniversaire",
    "profile.fields.created": "Enregistré le",
    "profile.delete.title": "Supprimer le profil",
    "profile.delete.body": "Supprime tes voyages et bucket list puis te déconnecte.",
    "profile.delete.button": "Supprimer le profil",
    "profile.delete.confirm": "Vraiment supprimer ?",
    "profile.error.auth": "Merci de te reconnecter.",
    "profile.error.delete": "Échec de la suppression. Merci de réessayer plus tard.",
    "profile.delete.marked": "Ton compte a été marqué pour suppression. Tu peux le réactiver sous 30 jours.",
    "profile.hero.eyebrow": "Ton profil",
    "profile.hero.since": "depuis",
    "profile.warning.title": "Marqué pour suppression",
    "profile.warning.body": "Ton compte sera supprimé définitivement après {date}.",
    "profile.warning.hint": "Reconnecte-toi ou clique ci-dessous pour le réactiver immédiatement.",
    "profile.warning.reactivate": "Réactiver le compte",
    "profile.delete.hint": "Ton compte est conservé 30 jours pour récupération. Tu peux le réactiver durant ce délai; après il sera supprimé.",
    "profile.delete.confirmTitle": "Tu es sûr ?",
    "profile.delete.confirmHint": "Cette étape marque ton compte pour suppression.",
    "profile.delete.markAction": "Marquer définitivement",
    "profile.delete.loading": "Suppression..."
  },
  it: {
    "nav.reisen": "Viaggi",
    "nav.bucketlist": "Bucket List",
    "nav.karte": "Mappa",
    "nav.profil": "Profilo",
    "nav.logout": "Logout",
    "nav.language": "Lingua",

    "auth.loginTitle": "Accedi",
    "auth.loginSubtitle": "Accedi con e-mail o Google.",
    "auth.email": "E-mail",
    "auth.password": "Password",
    "auth.loginButton": "Accedi",
    "auth.or": "OPPURE",
    "auth.google": "Accedi con Google",
    "auth.noAccount": "Non hai un account?",
    "auth.registerNow": "Registrati ora",
    "auth.verifyHint": "Conferma il tuo indirizzo e-mail. Controlla anche lo spam.",

    "register.title": "Registrazione",
    "register.subtitle": "Crea il tuo diario di viaggio e conserva i ricordi più belli.",
    "register.firstname": "Nome",
    "register.lastname": "Cognome",
    "register.birthday": "Data di nascita",
    "register.email": "E-mail",
    "register.password": "Password",
    "register.submit": "Registrati",
    "register.loading": "Registrazione...",
    "register.success": "Registrazione riuscita! Conferma l'e-mail. Controlla anche lo spam.",
    "register.duplicate": "Questa e-mail è già registrata. Accedi.",
    "register.noAccount": "Hai già un account?",
    "register.loginNow": "Accedi ora"

    ,
    "home.title": "Ciao {name}",
    "home.subtitle": "I tuoi viaggi, bucket list e globo in un'unica vista.",
    "home.trips": "Viaggi",
    "home.tripsHint": "I tuoi viaggi a colpo d'occhio",
    "home.tripsEmpty": "Non hai ancora aggiunto viaggi.",
    "home.bucket": "Bucket List",
    "home.bucketHint": "Le tue prossime mete",
    "home.bucketEmpty": "Nessun obiettivo aggiunto.",
    "home.bucketError": "Impossibile caricare la bucket list.",
    "home.map": "Mappa del mondo"
    ,
    "trips.title": "I miei viaggi",
    "trips.cta": "Aggiungi un viaggio",
    "trips.empty": "Non hai ancora aggiunto viaggi. Clicca su \"Aggiungi un viaggio\".",
    "trips.loading": "Caricamento viaggi..."
    ,
    "bucket.title": "Bucket List",
    "bucket.cta": "Aggiungi una destinazione da sogno",
    "bucket.loading": "Caricamento bucket list...",
    "bucket.empty": "Nessuna bucket list. Aggiungi una destinazione da sogno.",
    "bucket.error": "Impossibile caricare la bucket list.",
    "bucket.itemYear": "Previsto: {year}"
    ,
    "tripForm.title": "Aggiungi viaggio",
    "tripForm.location": "Luogo",
    "tripForm.withWhom": "Con chi",
    "tripForm.cost": "Costo (CHF)",
    "tripForm.rating": "Voto (1-10)",
    "tripForm.description": "Descrizione",
    "tripForm.images": "Carica immagini",
    "tripForm.start": "Data inizio",
    "tripForm.end": "Data fine",
    "tripForm.save": "Salva",
    "tripForm.cancel": "Annulla",
    "tripForm.error": "Compila tutti i campi obbligatori.",
    "tripForm.errorAuth": "Effettua di nuovo l'accesso.",
    "tripForm.errorLocation": "Imposta una posizione sulla mappa.",
    "tripForm.errorSave": "Impossibile salvare il viaggio.",
    "tripForm.errorUpload": "Caricamento immagine non riuscito.",
    "tripForm.errorMongo": "Impossibile salvare il viaggio in MongoDB.",
    "tripForm.placeholder.location": "es. Parigi",
    "tripForm.placeholder.withWhom": "es. Luis",
    "tripForm.placeholder.cost": "es. 1200",
    "tripForm.placeholder.rating": "es. 8",
    "tripForm.placeholder.description": "Momenti speciali, highlight, ricordi...",
    "tripForm.locationPicker": "Imposta posizione (viaggio)",
    "bucketForm.title": "Aggiungi destinazione da sogno",
    "bucketForm.name": "Luogo",
    "bucketForm.images": "Carica immagini",
    "bucketForm.locationPicker": "Imposta posizione (bucket list)",
    "bucketForm.ideas": "Appunti / Idee",
    "bucketForm.placeholder.name": "es. Bora Bora",
    "bucketForm.placeholder.ideas": "• Luoghi imperdibili\n• Ristoranti da provare\n• Attività sull'acqua/vicino all'acqua",
    "bucketForm.save": "Salva destinazione da sogno",
    "bucketForm.cancel": "Annulla",
    "bucketForm.errorAuth": "Effettua di nuovo l'accesso (utente non trovato).",
    "bucketForm.errorUpload": "Caricamento immagine non riuscito:",
    "bucketForm.errorLocation": "Imposta una posizione sulla mappa.",
    "bucketForm.errorSave": "Impossibile salvare la destinazione da sogno."
    ,
    "profile.title": "Profilo",
    "profile.cards.reisen": "Viaggi",
    "profile.cards.bucket": "Bucket list",
    "profile.cards.costs": "Costi totali viaggi",
    "profile.cards.tripsLabel": "Viaggi registrati",
    "profile.cards.bucketLabel": "Obiettivi in attesa",
    "profile.cards.costsLabel": "CHF (somma di tutti i viaggi)",
    "profile.fields.firstname": "Nome",
    "profile.fields.lastname": "Cognome",
    "profile.fields.email": "E-mail",
    "profile.fields.userId": "ID utente",
    "profile.fields.birthday": "Data di nascita",
    "profile.fields.created": "Registrato il",
    "profile.delete.title": "Elimina profilo",
    "profile.delete.body": "Rimuove i tuoi viaggi e bucket list e ti disconnette.",
    "profile.delete.button": "Elimina profilo",
    "profile.delete.confirm": "Eliminare davvero?",
    "profile.error.auth": "Accedi di nuovo.",
    "profile.error.delete": "Eliminazione non riuscita. Riprova più tardi.",
    "profile.delete.marked": "Il tuo account è stato segnato per l'eliminazione. Puoi riattivarlo entro 30 giorni.",
    "profile.hero.eyebrow": "Il tuo profilo",
    "profile.hero.since": "dal",
    "profile.warning.title": "Contrassegnato per l'eliminazione",
    "profile.warning.body": "Il tuo account sarà rimosso definitivamente dopo {date}.",
    "profile.warning.hint": "Accedi o clicca qui sotto per riattivarlo subito.",
    "profile.warning.reactivate": "Riattiva account",
    "profile.delete.hint": "Il tuo account è conservato per 30 giorni per il recupero. In questo periodo puoi riattivarlo; poi sarà eliminato.",
    "profile.delete.confirmTitle": "Sei sicuro?",
    "profile.delete.confirmHint": "Questo passaggio contrassegna il tuo account per l'eliminazione.",
    "profile.delete.markAction": "Contrassegna definitivamente",
    "profile.delete.loading": "Eliminazione in corso..."
  }
};

function loadInitialLang(): Lang {
  if (typeof localStorage === "undefined") return defaultLang;
  const stored = localStorage.getItem("lang") as Lang | null;
  if (stored && dictionaries[stored]) return stored;
  return defaultLang;
}

export const lang = writable<Lang>(loadInitialLang());

lang.subscribe((val) => {
  if (typeof localStorage !== "undefined") {
    localStorage.setItem("lang", val);
  }
});

export const t = derived(lang, ($lang) => {
  const dict = dictionaries[$lang] ?? dictionaries[defaultLang];
  return (key: string) => dict[key] ?? dictionaries[defaultLang][key] ?? key;
});

export const availableLanguages: { code: Lang; label: string }[] = [
  { code: "de", label: "Deutsch" },
  { code: "en", label: "English" },
  { code: "fr", label: "Français" },
  { code: "it", label: "Italiano" }
];
